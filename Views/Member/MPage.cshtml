@using Microsoft.AspNetCore.Mvc
@using Microsoft.AspNetCore.Mvc.Razor
@model ModelView

@{
    string member = @Model.member;
    string temp = member+"-fond";
    string fond = @Model.Color[temp];
    temp = member+"-tour";
    string tour = @Model.Color[temp];
    temp = member+"-name";
    string name = @Model.IntroPage[temp];
    temp = member+"-prg";
    string prg = @Model.IntroPage[temp];
}

<style>
    body {background-color: @fond}
    .pretty-link:hover {
        color: @tour;
    }
    .album-title {
        margin-top: 40px;
        font-size: 1.5em;
        font-weight: bold;
        padding: 10px;
        width: 100%;
        background-color: @tour;
        color: #ffffff;
    }
    .cercle {
    width: 280px;
    height: 280px;
    object-fit: cover;
    border-radius: 50%;
    flex-shrink: 0;          /* empêche l’image de se rétrécir */
    border: 8px solid @tour;
    }
    .btn-personnalise {
    background-color: @tour;  /* couleur de fond */
    color: white;               /* couleur du texte */
    font-size: 24px;            /* taille du texte */
    padding: 24px 72px;         /* espace à l'intérieur du bouton */
    border: none;               /* supprime la bordure par défaut */
    border-radius: 8px;         /* arrondit les coins */
    cursor: pointer;            /* change le curseur au survol */
    box-shadow: 0 4px 6px rgba(0,0,0,0.1); /* optionnel : ombre */
    transition: all 0.3s ease;  /* effet de transition pour hover */
    }
</style>




<form asp-action="recupererValeurs" asp-controller="Member" method="post">
    @Html.AntiForgeryToken()


<div class="container-fluid">
    <div class="row align-items-start">
        <!-- Image sur 2 colonnes -->
        <div class="col-3">
            <img src="@Url.Content($"~/Avatar/{Model.member}.png")" class="img-fluid cercle" alt="Photo de profil">
        </div>

        <!-- Texte sur 10 colonnes -->
        <div class="col-9">
            <h2 class="title">@name</h2>
            <p>@prg</p>
        </div>
    </div>
</div>


<br>

<!-- Sommaire -->
<div class="d-flex justify-content-center">
    <div class="liste-colorée mb-5 text-center">
        <div class="row justify-content-center">
            <div class="col-auto">
                <ul>
                    @for(int j=0; j<Model.Albums.Count/2; j++)
                    {
                        <li><a href="#album-@Model.Albums[j]" class="pretty-link">@Model.Albums[j]</a></li>
                    }
                </ul>
            </div>
            <div class="col-auto">
                <ul>
                    @for(int j=Model.Albums.Count/2; j<Model.Albums.Count; j++)
                    {
                        <li><a href="#album-@Model.Albums[j]" class="pretty-link">@Model.Albums[j]</a></li>
                    }
                </ul>
            </div>
        </div>
    </div>
</div>








    @for(int j=0; j<Model.Albums.Count; j++)
    {
        var album = Model.Questions.Where(q => q.pc.album == Model.Albums[j]).OrderBy(q => q.pc.category).ThenBy(q => q.pc.publisher).ToList();

        <div class="album">
            <h3 id="@album[0].pc.album" class="album-title">@album[0].pc.album</h3>
        </div>

        <div class="album-grid" id="album-@album[0].pc.album">
            @{
                string? currentKey = null;
                int indexInGroup = 0;
            }

            @for (int i = 0; i < album.Count(); i++)
            {
                string groupKey = album[i].pc.category == "Merch" || album[i].pc.category == "POBs" || album[i].pc.category == "POBs Japonais" ? album[i].pc.publisher : album[i].pc.category;

                if (groupKey != currentKey)
                {
                    currentKey = groupKey;
                    indexInGroup = 0;
                }

                var color = Model.Color.ContainsKey(groupKey) ? Model.Color[groupKey] : "#ccc";


                <div class="image-wrapper">
                    <div class="category-bar" style="background-color:@color">
                        @(indexInGroup == 0 ? groupKey : "")
                    </div>

                    <img src="@Url.Content($"~/ImagesATEEZ/{Model.Questions[i].Name}.png")"
                        alt="@Model.Questions[i].Name"
                        style="width:140px;height:auto;" />

                    <input type="hidden" name="Questions[@i].Name" value="@Model.Questions[i].Name" />

                    <select name="Questions[@i].Selection" class="form-select">
                        <option value="I" selected="@(Model.Questions[i].Selection == "I" ? "selected" : null)">Indifferent</option>
                        <option value="H" selected="@(Model.Questions[i].Selection == "H" ? "selected" : null)">I have it</option>
                        <option value="W" selected="@(Model.Questions[i].Selection == "W" ? "selected" : null)">I want it</option>
                        <option value="P" selected="@(Model.Questions[i].Selection == "P" ? "selected" : null)">Top priority</option>
                    </select>
                </div>

                indexInGroup++;
            }
        </div>
    }


    <br>
    <br>
    <div class="btn-wrapper">
        <button type="submit" class="btn-personnalise">Save</button>
    </div>
</form>

<footer id="footer">
    <p>...</p>
</footer>




<!-- Bouton -->
<button id="btn1" class="btn-fixe">Save</button>
<button id="btn2" class="btn-fixe">Top</button>

